<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="content-type" content="text/html; charset=UTF-8">
        <meta charset="utf-8">
        <title>ModBus Module — Keep Talking and Nobody Explodes Module</title>
        <meta name="viewport" content="initial-scale=1">
        <link rel="stylesheet" type="text/css" href="css/normalize.css">
        <link rel="stylesheet" type="text/css" href="css/main.css">
        <link href='https://fonts.googleapis.com/css?family=Special+Elite' rel='stylesheet' type='text/css'>
        <script src="js/highlighter.js"></script>
        <style>
            table {
                margin: 1em auto;
            }

            /* Example CSS; Remove what is not used.*/
            .bold {
                font-weight: bold;
            }
            .underline {
                text-decoration: underline;
            }
            .italics {
                font-style: italic;
            }

            img.center {
                display: block;
                margin-left: auto;
                margin-right: auto;
            }
            img.example-image {
                width: 60%;
            }
        </style>
		<style>
            /* Remove this <style> block in final manual! */
            code {background-color: rgb(235, 235, 200);}
            code.notcode {background-color: white;}
            li ol {margin: 0;}
            kbd {background-color: #f5f5f5;border-style: solid;border-width: 1px 2px 2px 1px;padding: 0 1px;}
        </style>
    </head>
    <body>
        <div id="ManualContent">
            <div class="section">
                <div class="page page-bg-02">
                    <div class="page-header">
                        <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                        <span class="page-header-section-title">ModBus Module</span>
                    </div>
                    <div class="page-content">
                        <img src="img/Component/Module Name.svg" class="diagram">
                        <h2>On the Subject of ModBus </h2>
                        <p class="flavour-text">"I got this, I'm a professional" was him last word.</p>
                        
                        <p>The ModBus is a serial communications protocol originally published by Modicon in 1979, for use with it's PLCs (Programmable logic controllers). </p>
						<p class="flavour-text">A little of History is good, right ? </p>
						
						<br>
						
						<p>It's now commonly available means of connecting industrial electronic devices...and can be use to make some bomb.<br>
						To defuse the module, it's simple, you only need to send the right frame.<br>
						Don't send anything before finishing writing the frame.</p>
						
						<p class="flavour-text"> You just have to follow the instructions. As simple as cooking a turkey ! </p>
						
						<br>
						
                        <h2>ModBus Protocol</h2>
						<p class="flavour-text"> "READ THIS SECTION ! please."</p>
						<p>Like we said before, you need to follow a strict protocol. We are lucky, bomber never use CRC (Cyclic redundancy check, "Error check").<br>
						Also, We know, they only use the RTU frame format describe below</p>
						
                        <img src="img/frameModBus.png" width="500" />
						<p class="flavour-text"> Like we said before, we don't need calculate the CRC (lucky you). <br>
						PS : Adress here correspond to the slave adress like the adress of the timer.</p>
						<p> 16 bits word (2 bytes) are send in "Big endian" (Must Signifiant Bit First).<br>
						i.e. : You have to send (42)<SUB>10</SUB> = (21)<SUB>HEX</SUB>, you need to send "2" then "1".</p>
						
						
						<h3> Adress </h3>
						<p class="flavour-text"> "Where I have to send the defuse code ?"</p>
						<p> For fill this, you need to watch the first number (or letter) of the serial code of the bomb.<br>
						Convert this (they are all in ASCII) in hexademal number (See Annex ASCII Tab), this is the adress (yay !).<p>
						<p class="flavour-text"> Don't use the decimal numbers ! </p>
                    </div>
                   <div class="page-footer relative-footer">Page 1 of 5</div>
                </div>
                <div class="page page-bg-01">
                    <div class="page-header">
                        <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                        <span class="page-header-section-title">ModBus Module</span>
                    </div>
                    <div class="page-content">
                        <h3> Function </h3>
						<p class="flavour-text"> "Hmm... I guess it's an important section..."</p>
						<p> Terrorist (or defuser, or someone else ?) use only 2 function :<p>
						<ol>
                            <li>The function 04, use to read a data word. (and Yes, we will use it)</li>
                            <li>The function 06, use to write a data word.</li>
                        </ol>
						<p> The choice is simple, look at the last number (or letter) of the serial code. <br>
						...Convert it into an decimal number. (they are all in ASCII)<br>
						THEN do the modulo 4 of this number(e.g. : 12%4 = 0,&nbsp&nbsp 15%4 = 3)</p>
						<p class="flavour-text"> "Simple, right ?" </p>
						<br>
						<p> After that, multiply by 3, and do the modulo 2 of the result<br>
						If the result is ... </p>
						<ol>
                            <li>&nbsp... 0, use the function 04.</li>
                            <li>&nbsp... 1, use the function 06.</li>
                        </ol>
						<h3>Function 04</h3>
						<p class="flavour-text"> Read a data, defuse the module, be an hero. BOOM dream archieve.</p>
						<p> Bomber develop a new kind of protection, you can't defuse the bomb by writing some data word at the right place.<br>
							You have to send the right frame, read a useless data but it will defuse automatically the module.<br>
							<br>
							So, How is compose the data area ? (Read the tab below)</p>	
						<img src="img/FrameFunction04.png" width="400" />
						<p class="flavour-text"> You see, It's the last 4 byte to find ! Keep calm and defuse it ! </p>
                    </div>
                   <div class="page-footer relative-footer">Page 2 of 5</div>
                </div>
                <div class="page page-bg-03">
                    <div class="page-header">
                        <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                        <span class="page-header-section-title">ModBus Module</span>
                    </div>
                    <div class="page-content">
						<h4>Adress of the word</h4>
						<p> Firstly, for the adress of the word, multiply the third number by the fourth number.<br>
							For letter, convert it in decimal with annex ASCII Tab.<br>
							For number, don't change it like above, take the number write (If it's write 5 take 5).<br>
							After that, multiply the result by 100.<br>
							Then, just take the less significant byte. <br>
							i.e. : (45BA72C)<SUB>HEX</SUB> -> (A72C)<SUB>HEX</SUB> <br> </p>
						<h4>Number of word to read</h4>	
						<p> Hmmm, you should think, "It's useless to say, i will read 210 word", I will respond you, Yes.<br>
							BUT, That not work like that, Bomber use this function sneaky, so they don't use the real purpose.<br>
							Please find these 2 last bytes (even if they don't correspond to anything).<br>
							<br>
							Take the adress of the slave (decimal), multiply by the the number of function (4 or 6) then add the data number (decimal too).<br>
							Convert into Hexa the result, simplify like just right before. And you got it !<br>
							<br>
							Send the data and you will be a hero (or not if you failed).<br></p>

						<h3>Function 06</h3>
						<p class="flavour-text"> Be carefull, the keyboard is stronger than the sword ! </p>
						<p> You previously determine the slave adress and the function "write". <br>
							But now you need to search what you need to write ? and where (in him slave memory)? <br>
							See below, how complete the data area when you want to write something.
						<img src="img/FrameFunction06.png" width="400" />
						<p class="flavour-text"> I believe in you ! You got this ! </p>
                    </div>
                    <div class="page-footer relative-footer">Page 3 of 5</div>
                </div>
				<div class="page page-bg-04">
                    <div class="page-header">
                        <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                        <span class="page-header-section-title">ModBus Module</span>
                    </div>
                    <div class="page-content">
						<h4>Adress in the register</h4>
						<p> I hope you review your binary operation become you will use it ! (It's not a joke). <br>
							First step, take the 4th number (or letter, there are all ASCII), convert it with ASCII table (in binary this time).<br>
							*When you got the number, complete with some 0 before to convert it into the same number in 16 bits this time. exemple : 101 = 0000 0101 (for 8 bits).<br>
							You have to invert this number (NOT Operation), truth table below : </p>
						<table>
							<tr>
								<th>&nbsp&nbsp A &nbsp&nbsp </th>
								<th>NOT A</th>
							</tr>
							<tr>
								<td> &nbsp&nbsp 1 </td>
								<td> &nbsp&nbsp 0 </td>
							</tr>
							<tr>
								<td> &nbsp&nbsp 0</td>
								<td> &nbsp&nbsp 1</td>
							</tr>
						</table>
						<p> You just have to convert the 16 bits binary number into an decimal number.<br>
							Simplify by cut the higher value. i.e. : 265486 -> 5486 <br>
							Annnnndddd, you got the adress in the register.</p>
						
						<h4>Value</h4>
						<p> The last part is the easiest ! For find the value to enter at this adress, take the first serial number (decimal) soustract the number of function.<br>
							Then multiply this result by the 5th serial Number (or lettre), in decimal for sure. Simplify like above.</p>
						<p> If you there, you think it's finish, and yes, it's finish ! <br>
							Now, enter all parameter in the right order, and click on the send button.<br>
							YOU DID IT MY BOY !</p>
                    </div>
                    <div class="page-footer relative-footer">Page 4 of 5</div>
                </div>
				<div class="page page-bg-05">
                    <div class="page-header">
                        <span class="page-header-doc-title">Keep Talking and Nobody Explodes Mod</span>
                        <span class="page-header-section-title">Appendix Name</span>
                    </div>
                    <div class="page-content">
						<h2>Annex ASCII table</h2>
						<img src="img/ascii_table.png" width="650" />
						<p class="flavour-text"> When you need to convert a letter (or an number in some case), you need to find the letter (or number) into the Char column <br>
												 Bonus : You got Dec/Bin/Hex/Char Convertion</p>
                    </div>
                    <div class="page-footer relative-footer">Page 5 of 5</div>
                </div>
            </div>
        </div>
    </body>
</html>